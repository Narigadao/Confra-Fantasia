<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Confraterniza√ß√£o GS1 - Resultados</title>
<style>
body {
  background: black; color: white; font-family: Arial; text-align: center; padding: 30px;
}
table {
  margin: 0 auto; width: 80%; border-collapse: collapse; font-size: 20px;
}
th, td {
  padding: 12px; border-bottom: 1px solid #555;
}
th { color: #00bfff; }
</style>
</head>
<body>
  <h1>Resultados em Tempo Real üèÜ</h1>
  <div id="tabela"></div>

  <script>
  const api = "https://script.google.com/macros/s/AKfycbwrkLD_b5bH_pNQJ2_Md4ng82SmBSrY_lagx7FVaFz9FmCh8Rv7EmnzhtHpa_ooQN5etA/exec";

  async function atualizar() {
    const res = await fetch(api);
    const dados = await res.json();
    dados.sort((a, b) => b.voto - a.voto);
    let html = "<table><tr><th>Nome</th><th>Fantasia</th><th>Votos</th></tr>";
    dados.forEach(p => {
      html += `<tr><td>${p.nome}</td><td>${p.fantasia}</td><td>${p.voto}</td></tr>`;
    });
    html += "</table>";
    document.getElementById("tabela").innerHTML = html;
  }

  setInterval(atualizar, 5000);
  atualizar();
  </script>
</body>
</html>
